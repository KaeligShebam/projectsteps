{% extends 'base.html.twig' %}

{% block content %}
<!doctype html>
<html lang="fr">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>{%  block title %}Accueil - {% block title_base %}{{ parent() }}{% endblock %}{% endblock %}</title>
    </style>
</head>
	<body>
		<div class="mb-5">
			<h1 class="text-center color-blue-dark-shebam mb-3">Étapes projets</h1>
			<hr>		
			<div class="row">
				<div class="col padding-mobile">
					<div class="text-center bg-yellow-shebam color-white-shebam p-3 font-weight-bold">Priorité 1</div>
					<table id="tableOrderSteps" class="table mb-5" data-toggle="table"
					{# {% if is_granted('IS_AUTHENTICATED_FULLY') and is_granted('ROLE_ADMIN')%} #}
					data-use-row-attr-func="true" data-reorderable-rows="true"
					{# {% endif %} #}
					>
						<thead class="bg-grey-shebam color-white-shebam font-weight-bold">
							<tr>
								<th data-field="id" data-visible="false">ID</th>
								<th data-field="customer" data-sortable="true" scope="col">Test</th>
								<th data-field="subject" data-sortable="true" scope="col">Test</th>
								<th data-field="person" data-sortable="true" scope="col">Test(s)</th>
								{# {% if is_granted('IS_AUTHENTICATED_FULLY') and is_granted('ROLE_ADMIN')%} #}
									<th scope="col">Action</th>
								{# {% endif %} #}
							</tr>
						</thead>
						<tbody>
							{# {% for task in task %}
								{% if task.archived == 0 %} #}
									<tr class="bg-white-shebam">
										<td>1</td>
										<td><input type="checkbox"></td>
										<td><input type="checkbox"></td>
										<td><input type="checkbox"></td>
									{# {% if is_granted('IS_AUTHENTICATED_FULLY') and is_granted('ROLE_ADMIN')%} #}
										<td>
											<a href=""><i class="fas fa-cog"></i></a>
											|
											<a href="" onclick="return confirm('Attention vous vous apprettez à supprimer une étape')"><i class="fas fa-trash"></i></a>
										</td>
									{# {% endif %} #}
									</tr>
								{# {% endif %} #}
							{# {% endfor %} #}
						</tbody>
					</table>
					{# {% if is_granted('IS_AUTHENTICATED_FULLY') and is_granted('ROLE_ADMIN')%} #}
						<div class="btn-add-task-home">
							<p class="mt-3 text-center"><a class="btn-yellow-shebam" href="#ajouteruneetape">Ajouter une étape</a></p>
						</div>
						<div class="btn-add-task-home-mobile">
							<p class="mt-3 text-center"><a class="btn-yellow-shebam" href="">Ajouter</a></p>
						</div>
					{# {% endif %} #}
				</div>

			<!-- POPUP -->
			<!-- Steps -->
			{# <div id="ajouteruneetape" class="overlay">
				<div class="was-validated popup bg-white-light-shebam is-valid">
					<h2 class="mb-4">Ajout d'une tâche P1</h2>
					<a class="close" href=""><i class="fas fa-times"></i></a>
						<div class="content">
						{{ form_start(form_task_p1_add_front) }}
								<div class="form-group">
									{{ form_row(form_task_p1_add_front.customer) }}
									{{ form_row(form_task_p1_add_front.object) }}
									{{ form_row(form_task_p1_add_front.subobject1) }}
									{{ form_row(form_task_p1_add_front.subobject2) }}
									{{ form_row(form_task_p1_add_front.subobject3) }}
									{{ form_row(form_task_p1_add_front.users) }}
								</div>
								<div class="form-group">
									{{ form_row(form_task_p1_add_front.submit) }}
								</div>
						{{ form_end(form_task_p1_add_front) }}
					</div>
				</div>
			</div> #}

		</div>
	</body>
</html>
{%  endblock %}
 {% block javascripts %}
	{{ parent() }}
	<script>
		$(()=>{
			$("#tableOrderSteps").on("reorder-row.bs.table", (e, table, row, old) => {
				$.ajax({
					url: "{{ path('home_reorder_row')}}",
					method: "POST",
					data: {
						table: JSON.stringify(table),
						context: 1
					},
					dataType: "JSON",
					success: (response)=>{console.log(response)}
				})
			})
		})
	</script>
{% endblock %}